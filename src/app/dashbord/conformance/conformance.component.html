<!-- ========================= Main ==================== -->
<div class="main">
    <div class="topbar">
        <div class="toggle">
            <ion-icon name="menu-outline"></ion-icon>
        </div>
        <div class="search">
            <label>
                <input type="text" placeholder="Search here">
                <ion-icon name="search-outline"></ion-icon>
            </label>
        </div>
        <div class="user">
            <img src="assets/as/imgs/customer01.jpg" alt="">
        </div>
    </div>
    <div class="conformance">
        <!-- ======================= Formulaire Non-Conformance ================== -->
        <div class="non-conformance-form">
            <h2>{{ isEditMode ? 'Modifier la non-conformité' : 'Ajouter une nouvelle non-conformité' }}</h2>
            <form #nonConformanceForm="ngForm" (ngSubmit)="onSubmit(nonConformanceForm.value)">
                <div class="form-group">
                    <label for="title">Titre</label>
                    <input type="text" id="title" name="title" [(ngModel)]="nonConformance.title" required placeholder="Ex: Problème de qualité">
                </div>
                <div class="form-group">
                    <label for="description">Description</label>
                    <textarea id="description" name="description" [(ngModel)]="nonConformance.description" required placeholder="Ex: Description détaillée du problème..."></textarea>
                </div>
                <div class="form-group">
                    <label for="status">Statut</label>
                    <select id="status" name="status" [(ngModel)]="nonConformance.status" required>
                        <option value="OPEN">Ouverte</option>
                        <option value="IN_PROGRESS">En cours</option>
                        <option value="CLOSED">Fermée</option>
                    </select>
                </div>
            
                <div class="form-group">
                    <label for="assignedTo">Assignée à</label>
                    <input type="text" id="assignedTo" name="assignedTo" [(ngModel)]="nonConformance.assignedTo" placeholder="Ex: Nom de la personne (optionnel)">
                </div>
                <button type="submit" class="btn-submit" [disabled]="!nonConformanceForm.valid">
                    {{ isEditMode ? 'Mettre à jour' : 'Ajouter' }}
                </button>
                <button type="button" class="btn-cancel" (click)="resetForm()" *ngIf="isEditMode">Annuler</button>
            </form>
        </div>



    <!-- ======================= Tableau des Non-Conformances ================== -->
    <div class="non-conformance-table">
        <h2>Liste des non-conformités</h2>
        <table>
            <thead>
                <tr>
                    <th>#</th>
                    <th>Titre</th>
                    <th>Description</th>
                    <th>Statut</th>
                    <th>Date de création</th>
                    <th>Date de mise à jour</th>
                    <th>Assignée à</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let nc of nonConformances; let i = index">
                    <td>{{ i + 1 }}</td>
                    <td>{{ nc.title }}</td>
                    <td>{{ nc.description }}</td>
                    <td>{{ nc.status }}</td>
                    <td>{{ nc.createdAt | date:'yyyy-MM-dd HH:mm' }}</td>
                    <td>{{ nc.updatedAt | date:'yyyy-MM-dd HH:mm' }}</td>
                    <td>{{ nc.assignedTo || 'Non assigné' }}</td>
                    <td>
                        <button (click)="editNonConformance(nc)">Modifier</button>
                        <button (click)="deleteNonConformance(nc.id)">Supprimer</button>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
    </div>